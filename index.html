<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì½”ë“œëª…: ì—ê·¸ ë…¸ì´ì¦ˆ - í•„ë“œ ë¡œê·¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=East+Sea+Dokdo&family=Noto+Sans+KR:wght@400;500;700&family=Noto+Serif+KR:wght@400;700;900&display=swap" rel="stylesheet">

  <style>
    /* ========================================= */
    /* 1. ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    /* ========================================= */
    :root {
      --bg-gray: #111827;
      --paper: #faf7f2;
      --text-main: #2d2d2d;
      --accent-red: #d32f2f;
      --accent-blue: #2563eb;
      --survey-bg: #FFD94D;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; min-height: 100vh; background: var(--bg-gray);
      font-family: 'Noto Sans KR', sans-serif; line-height: 1.6;
    }

    .txt-red { color: #d32f2f; font-weight: 700; }
    .txt-blue { color: #2563eb; font-weight: 700; }
    .txt-highlight {
      background: linear-gradient(120deg, rgba(253, 224, 71, 0.5) 0%, rgba(253, 224, 71, 0.3) 100%);
      box-shadow: inset 0 -8px 0 rgba(253, 224, 71, 0.4); padding: 0 2px; font-weight: 700; color: #422006;
    }
    
    .txt-handwritten {
      display: block; font-family: 'East Sea Dokdo', cursive; font-size: 1.9rem; color: #5d4037;
      line-height: 1.3; padding: 15px; margin: 16px 0;
      background: rgba(139, 115, 85, 0.08); border-left: 4px solid #8b7355;
      border-radius: 0 8px 8px 0; transform: rotate(-0.5deg);
    }

    /* ë…¸íŠ¸ë¶ ë ˆì´ì•„ì›ƒ */
    .notebook-card { width: 100%; max-width: 600px; margin: 0 auto; min-height: 100vh; background: #020617; display: flex; flex-direction: column; }
    .spiral-header { padding: 12px 16px 8px; background: linear-gradient(135deg, #020617, #111827); color: #9ca3af; box-shadow: 0 2px 6px rgba(0,0,0,0.5); z-index: 10; }
    .spiral-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
    .spiral-holes { display: flex; gap: 6px; }
    .spiral-hole { width: 13px; height: 13px; border-radius: 999px; background: #020617; box-shadow: 0 0 0 2px #d4d4d4, inset 0 0 3px rgba(0,0,0,0.9); position: relative; }
    .spiral-wire { position: absolute; left: 50%; transform: translateX(-50%); width: 19px; height: 3px; border-radius: 999px; background: #d4d4d4; box-shadow: 0 2px 0 rgba(0,0,0,0.4), 0 -1px 0 rgba(255,255,255,0.7); }
    .spiral-wire.top { top: -6px; } .spiral-wire.bottom { bottom: -6px; }
    .lab-header-text { text-align: right; font-size: 0.7rem; letter-spacing: 0.1em; color: #6b7280; font-weight: 500; }
    .lab-main-title { margin-top: 4px; font-size: 1.1rem; font-weight: 800; letter-spacing: 0.1em; color: #e5e7eb; }
    .lab-subtitle { margin-top: 2px; font-size: 0.8rem; letter-spacing: 0.15em; color: #9ca3af; }

    .paper-wrap { flex: 1; background: #111827; padding: 0; overflow-y: auto; position: relative; }
    .paper { position: relative; padding: 24px 20px 40px 24px; min-height: 100%; background: var(--paper); background-image: repeating-linear-gradient(to bottom, transparent 0, transparent 27px, #e2ddd4 28px); }
    .paper::before { content: ""; position: absolute; top: 0; bottom: 0; left: 12px; width: 2px; background: linear-gradient(to bottom, transparent, #b8987b, transparent); opacity: 0.7; }

    .paper-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24px; }
    .paper-label { font-size: 0.75rem; color: #555; letter-spacing: 0.1em; font-weight: 700; margin-bottom: 4px; }
    .paper-title { font-size: 1.3rem; font-weight: 800; color: var(--text-main); line-height: 1.3; letter-spacing: -0.03em; }
    .stage-stamp { display: inline-block; padding: 4px 10px; border: 3px solid var(--accent-red); border-radius: 8px; color: var(--accent-red); font-size: 1rem; font-weight: 900; background: rgba(255, 255, 255, 0.85); transform: rotate(-3deg); font-family: 'Noto Serif KR', serif; }

    .nav-controls { display: flex; justify-content: space-between; margin-bottom: 24px; padding: 0 4px; }
    .nav-btn { padding: 10px 18px; font-size: 0.9rem; font-weight: 700; background: #ffffff; color: #374151; border: 1px solid #c4b5a5; border-radius: 8px; box-shadow: 0 2px 0 #b3a292; cursor: pointer; }
    .nav-btn:disabled { opacity: 0.5; cursor: not-allowed; background: #f3f4f6; border-color: #e5e7eb; box-shadow: none; transform: none; }
    
    .subtitle { font-size: 0.95rem; color: #666; margin: 4px 0 6px; font-weight: 600; letter-spacing: -0.02em; }
    .subtitle-separator { width: 100%; height: 2px; background: #e2ddd4; margin: 12px 0 24px; }

    .story-text { font-size: 1.05rem; color: #333; white-space: pre-line; line-height: 1.75; margin-bottom: 30px; word-break: keep-all; letter-spacing: -0.03em; text-align: left; }
    .section-title { font-weight: 700; color: #111; display: inline-block; margin-bottom: 4px; border-bottom: 2px solid rgba(0,0,0,0.1); }

    #answerArea { background: rgba(255,255,255,0.7); padding: 20px 16px; border-radius: 12px; border: 1px solid #e2ddd4; }
    .answer-label-pill { display: inline-block; padding: 4px 10px; border-radius: 6px; background: var(--text-main); color: #fff; font-size: 0.8rem; font-weight: 700; margin-bottom: 8px; }
    input[type="text"] { width: 100%; padding: 12px; border-radius: 8px; border: 2px solid #dcdcdc; font-size: 1.1rem; background: #ffffff; color: var(--text-main); transition: all 0.2s; }
    input:focus { outline: none; border-color: var(--accent-blue); box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
    button#submitBtn { width: 100%; margin-top: 12px; padding: 14px; border-radius: 8px; border: none; background: #111; color: #ffffff; font-size: 1rem; font-weight: 700; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.15); }
    
    .message { margin-top: 8px; font-size: 0.95rem; font-weight: 700; text-align: center; }
    .message.error { color: #d32f2f; }
    .message.success { color: #15803d; padding: 10px; background-color: #dcfce7; border-radius: 8px; border: 1px solid #bbf7d0; }

    .hint-area details { border: 1px solid #d1d5db; border-radius: 8px; background: #fff; margin-top: 12px; overflow: hidden; }
    .hint-area summary { padding: 12px 14px; font-size: 0.95rem; font-weight: 700; cursor: pointer; color: #4b5563; background: #f9fafb; list-style: none; }
    .hint-content { padding: 16px; font-size: 1rem; color: #333; border-top: 1px solid #e5e7eb; word-break: keep-all; }

    /* í´ë¦¬ì–´ í™”ë©´ */
    .clear-block { margin-top: 60px; text-align: center; display: none; padding: 0 20px; }
    .clear-badge { display: inline-flex; align-items: center; gap: 6px; padding: 6px 16px; border-radius: 999px; border: 2px solid #2563eb; color: #2563eb; font-size: 0.9rem; font-weight: 800; background: #eff6ff; margin-bottom: 20px; }
    .clear-title { font-size: 1.8rem; font-weight: 800; margin-bottom: 12px; color: #111; letter-spacing: -0.03em; }
    
    .survey-btn-wrap { margin: 20px 0; padding: 20px 0; border-top: 2px dashed #d1d5db; border-bottom: 2px dashed #d1d5db; }
    .survey-btn { padding: 16px 20px; border-radius: 12px; border: none; background: var(--survey-bg); color: #713f12; font-size: 1.1rem; font-weight: 800; cursor: pointer; box-shadow: 0 4px 0 #eab308; width: 100%; }
    .restart-btn { margin-top: 20px; width: 100%; padding: 14px 10px; border-radius: 999px; border: 1px solid #d1d5db; background: transparent; color: #6b7280; font-size: 0.85rem; font-weight: 600; cursor: pointer; }

    /* ========================================= */
    /* 2. [Type A] ì‹œìŠ¤í…œ ê²½ê³  ì˜¤ë²„ë ˆì´ */
    /* ========================================= */
    .warning-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.85);
      display: none; justify-content: center; align-items: center;
      z-index: 900; backdrop-filter: blur(3px);
    }
    .warning-box {
      width: 85%; max-width: 350px; background: #000;
      border: 2px solid #ff0000; padding: 25px; text-align: center;
      box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
      animation: shake 0.4s ease-out;
    }
    .warning-title { color: #ff0000; font-size: 1.6rem; font-weight: 900; margin: 0 0 10px 0; animation: blink 0.8s infinite; }
    .warning-msg { color: #fff; font-size: 0.95rem; margin-bottom: 20px; font-family: monospace; line-height: 1.5; }
    .warning-btn { background: #ff0000; color: #000; border: none; padding: 10px 20px; font-weight: 800; cursor: pointer; text-transform: uppercase; }
    
    @keyframes shake { 0% { transform: scale(0.9); } 60% { transform: scale(1.05); } 100% { transform: scale(1); } }
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

    /* ========================================= */
    /* 3. [Type C] ê¸€ë¦¬ì¹˜ ì˜¤ë²„ë ˆì´ (White Version + Center Fix) */
    /* ========================================= */
    .glitch-overlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: #ffffff; /* í•˜ì–€ìƒ‰ ë°°ê²½ */
      display: none; justify-content: center; align-items: center; flex-direction: column;
      z-index: 9999; overflow: hidden;
      /* [ìˆ˜ì •ë¨] í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ ê°•ì œ */
      text-align: center; 
    }
    .glitch-text {
      font-size: 2.5rem; font-weight: 900; color: #000;
      position: relative;
      animation: textShudder 0.1s infinite;
      /* [ìˆ˜ì •ë¨] ì¤‘ì•™ ì •ë ¬ ë° ì¤„ê°„ê²© í™•ë³´ */
      text-align: center; 
      line-height: 1.2;
      padding: 0 10px; /* ëª¨ë°”ì¼ ì¢Œìš° ì—¬ë°± */
    }
    .glitch-text::before, .glitch-text::after {
      content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0.7;
    }
    
    /* Error Mode: Red Glitch on White */
    .mode-error .glitch-text::before { color: #ff0000; z-index: -1; animation: glitch-1 0.3s infinite linear alternate-reverse; }
    .mode-error .glitch-text::after { color: #880000; z-index: -2; animation: glitch-2 0.3s infinite linear alternate-reverse; }
    .mode-error .sub-text { color: #ff0000; }

    /* Success Mode: Green/Cyan Glitch on White */
    .mode-success .glitch-text { animation: none; }
    .mode-success .glitch-text::before { color: #00cc00; z-index: -1; animation: glitch-1 0.5s infinite linear alternate-reverse; opacity: 0.5; }
    .mode-success .glitch-text::after { color: #00cccc; z-index: -2; animation: glitch-2 0.5s infinite linear alternate-reverse; opacity: 0.5; }
    .mode-success .sub-text { color: #008800; animation: none; }

    .sub-text { margin-top: 20px; font-family: monospace; font-weight: 700; text-align: center; }

    .scanlines {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: linear-gradient(to bottom, rgba(0,0,0,0), rgba(0,0,0,0) 50%, rgba(0,0,0,0.05) 50%, rgba(0,0,0,0.05)); 
      background-size: 100% 4px; pointer-events: none;
    }
    
    @keyframes textShudder { 0% { transform: translate(1px, 1px); } 100% { transform: translate(-1px, -1px); } }
    @keyframes glitch-1 { 0% { clip-path: inset(20% 0 80% 0); transform: translate(-2px, 0); } 100% { clip-path: inset(60% 0 10% 0); transform: translate(2px, 0); } }
    @keyframes glitch-2 { 0% { clip-path: inset(10% 0 60% 0); transform: translate(2px, 0); } 100% { clip-path: inset(80% 0 5% 0); transform: translate(-2px, 0); } }

  </style>
</head>
<body>
  
  <div class="glitch-overlay" id="glitchScreen">
    <div class="scanlines"></div>
    <div class="glitch-text" id="glitchMainText" data-text="SYSTEM FAILURE">SYSTEM FAILURE</div>
    <div class="sub-text" id="glitchSubText">CRITICAL ERROR: SUBJECT LOST</div>
  </div>

  <div class="notebook-card">
    <div class="spiral-header">
      <div class="spiral-row">
        <div class="spiral-holes">
          <div class="spiral-hole"><div class="spiral-wire top"></div><div class="spiral-wire bottom"></div></div>
          <div class="spiral-hole"><div class="spiral-wire top"></div><div class="spiral-wire bottom"></div></div>
          <div class="spiral-hole"><div class="spiral-wire top"></div><div class="spiral-wire bottom"></div></div>
        </div>
        <div class="lab-header-text">BACKWOODS RESEARCH INSTITUTE</div>
      </div>
      <div class="lab-main-title">CODE: EGG NOISE</div>
      <div class="lab-subtitle">GANGCHON BASE</div>
    </div>

    <div class="paper-wrap">
      <div class="warning-overlay" id="warningPopup">
        <div class="warning-box">
          <div class="warning-title">WARNING</div>
          <div class="warning-msg" id="warningMsg">
            </div>
          <button class="warning-btn" onclick="confirmWarning()">ì§„ì… ìŠ¹ì¸</button>
        </div>
      </div>

      <div class="paper">
        <div class="paper-header">
          <div class="paper-header-left">
            <div class="paper-label">FIELD NOTES</div>
            <div class="paper-title">ì½”ë“œëª…: ì—ê·¸ ë…¸ì´ì¦ˆ <br> (Code: Egg Noise)</div>
          </div>
          <div class="paper-header-right">
            <div class="stage-stamp" id="stageLabel">STAGE 1</div>
          </div>
        </div>

        <div class="progress-wrap"></div>

        <div class="nav-controls" id="navControls">
            <button class="nav-btn" id="prevBtn">â—€ ì´ì „</button>
            <button class="nav-btn" id="nextBtn">ë‹¤ìŒ â–¶</button>
        </div>

        <div id="gameContent">
            <div class="subtitle" id="stageSubtitle">í˜„ì¥ ë¡œê·¸ë¥¼ ì½ê³  ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.</div>
            <div class="subtitle-separator"></div>

            <div class="story-text" id="storyText">
            </div>

            <div id="answerArea">
                <div class="answer-label-pill">INPUT CODE</div>
                <input id="answerInput" type="text" placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”" inputmode="text" autocomplete="off" />
                <button id="submitBtn">í™•ì¸ (SUBMIT)</button>
                <div id="message" class="message"></div>

                <div id="hintArea" class="hint-area">
                    <details>
                        <summary id="hintSummary">íŒíŠ¸ í™•ì¸í•˜ê¸°</summary>
                        <div class="hint-content" id="hintContent"></div>
                    </details>
                </div>
            </div>
        </div>
        
        <div class="clear-block" id="clearBlock">
          <div class="clear-badge"><span>ğŸ‰</span><span>SYSTEM RESTORED</span></div>
          <div class="clear-title">ì‹œìŠ¤í…œ ë³µêµ¬ ì™„ë£Œ</div>
          <div class="clear-text">
            <strong>[ê²°ê³¼ ë³´ê³ ]</strong><br>
            13ë²ˆì§¸ ë¶€í’ˆì´ ì„±ê³µì ìœ¼ë¡œ ì¥ì°©ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
            ê°•ì´Œì˜ ì„¸ê³„ ìˆ˜ëª…ì´ ì—°ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.<br><br>
            ì—°êµ¬ì›ë‹˜ì˜ í—Œì‹ (Sacrifice)ì— ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.
          </div>

          <div class="survey-btn-wrap">
            <a href="https://forms.gle/y1YVeoTPLMm19ugSA" target="_blank" style="text-decoration: none;">
              <button class="survey-btn">ğŸ’¡ ë§Œì¡±ë„ ì¡°ì‚¬ ì°¸ì—¬í•˜ê¸°</button>
            </a>
          </div>
          <button class="restart-btn" id="restartBtn">ìƒˆë¡œìš´ ê°ì‘ì(ë£¨í”„) ëŒ€ê¸° ì¤‘...</button>
        </div>

      </div>
    </div>
  </div>

  <script>
    // [í˜„ì¥ ì²´ê° + ìˆ˜ì²© ë‹¨ì„œ + ë¶„ì„] ë¯¹ìŠ¤ ìŠ¤íƒ€ì¼ í…ìŠ¤íŠ¸
    const puzzles = [
      // 0. í”„ë¡¤ë¡œê·¸
      {
        subtitle: "í”„ë¡¤ë¡œê·¸. ì‚¬ë¼ì§„ ì‹œëŒ€ì˜ ì”í–¥",
        text: `<span class="section-title">í˜„ì¥ ê¸°ë¡</span><br>
    ê°•ì´Œì˜ ëŠ¥ì„ ì„ ë³´ë©´ ì™ ì§€ ëª¨ë¥¼ ìœ„í™”ê°ì´ ë“ ë‹¤. ì´ê³³ì˜ ì§€í˜•ì€ ë§ˆì¹˜ ê±°ëŒ€í•œ ë¬´ì–¸ê°€ê°€ ì›…í¬ë¦¬ê³  ì ë“  í˜•ìƒì´ë‹¤.<br><br>

    <span class="section-title">ì•„í‹°íŒ©íŠ¸ ë¶„ì„</span><br>
    ì‚°ì†ì—ì„œ ë°œê²¬ëœ <span class="txt-highlight">ì•Œ ëª¨ì–‘ì˜ ê²°ì •ì²´(Artifact)</span>. ë‹¨ìˆœí•œ ìœ ë¬¼ì´ ì•„ë‹ˆë‹¤. ì´ê³³ì— ì„œë¦° ì˜¤ë˜ëœ ê¸°ì–µì„ í¡ìˆ˜í•˜ë©° ë°˜ì‘í•˜ê³  ìˆë‹¤.<br><br>

    <span class="section-title">ì„ë¬´ ê°œì‹œ</span><br>
    í˜„ì¬ ì •ì²´ë¶ˆëª…ì˜ ì—ë„ˆì§€ ê³µì§„(Resonance)ì´ ê¸‰ì¦í•˜ê³  ìˆë‹¤. ë‹¹ì‹ ì€ ì´ë¥¼ ê°ì§€í•  ìˆ˜ ìˆëŠ” ìœ ì¼í•œ <span class="txt-blue">ê°ì‘ì(Sensor)</span>ë‹¤.<br><br>
    
    <strong>[ì§€ì‹œ]</strong> ê±°ëŒ€í•œ ë¬´ì–¸ê°€ê°€ ê¹¨ì–´ë‚˜ë ¤ í•œë‹¤. <strong>'ì‹œì‘'</strong>ì„ ì…ë ¥í•˜ì—¬ ì¡°ì‚¬ë¥¼ ê°œì‹œí•˜ë¼.`, 
        answer: "ì‹œì‘",
        hint: "í”„ë¡¤ë¡œê·¸ë¥¼ í™•ì¸í–ˆë‹¤ë©´ 'ì‹œì‘'ì„ ì…ë ¥í•˜ì„¸ìš”."
      },
      // 1. ì—­ -> ìƒë¡ (ìˆ˜ì²© ë°œê²¬)
      {
        subtitle: "í”„ë¡¤ë¡œê·¸. ìˆ˜ì²©ì„ ì¤ë‹¤",
        text: `<span class="section-title">ìœ„ì¹˜: ê°•ì´Œì—­ í”Œë«í¼</span><br>
    í…… ë¹ˆ í”Œë«í¼ì— ë°”ëŒ ì†Œë¦¬ê°€ ì„ì¸ <span class="txt-blue">ì´ëª…(ê³µëª…ìŒ)</span>ì´ ë“¤ë¦°ë‹¤.<br>
    ë°œì¹˜ì—ì„œ ë‚¡ì€ ìˆ˜ì²©ì„ ë°œê²¬í–ˆë‹¤. ì†ì„ ëŒ€ì ë¯¸ì„¸í•œ ì§„ë™ê³¼ í•¨ê»˜ ì²« ë²ˆì§¸ ë©”ì‹œì§€ê°€ ë– ì˜¬ëë‹¤.<br>

    <div class="txt-handwritten">
    ì´ ìˆ˜ì²©ì„ ì¤ëŠ” ì,<br>
    ê°•ì˜ ë§¥ë°•ì„ ë“£ê²Œ ë˜ë¦¬ë¼.
    </div>

    <span class="section-title">ë°ì´í„° ë¶„ì„</span><br>
    ìˆ˜ì²©ê³¼ ì•„í‹°íŒ©íŠ¸ê°€ ë™ê¸°í™”ë˜ì—ˆë‹¤. ê³µëª… ì‹ í˜¸ê°€ ê°€ë¦¬í‚¤ëŠ” ì²« ë²ˆì§¸ ì¢Œí‘œëŠ” ì—­ ì•ì˜ <strong>'ì¹´í˜'</strong>ë‹¤.<br><br>

    (ê°•ì˜ì‹¤ ë°–, ë²½ë©´ì˜ QRì½”ë“œë¥¼ í™•ì¸í•˜ì‹­ì‹œì˜¤.)`,
        answer: "ìƒë¡",
        hint: "ì •ë‹µ í˜•íƒœ: í•œê¸€, ê°€ë ¤ì§„ ë¶€ë¶„ì˜ ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”."
      },
      // 2. ìƒë¡ -> ì¢…ë§ (ë„ë¡œí‘œì§€íŒ)
      {
        subtitle: "1ì¥. ì”ì¬ íŒŒë™ì´ ê¹¨ì–´ë‚˜ë‹¤",
        text: `<span class="section-title">ìˆ˜ì²© í•´ë…</span><br>
    ì§€ë„ ìœ„ì— <span class="txt-highlight">í¬ë¯¸í•œ ì„ </span>ì´ í•ì¤„ì²˜ëŸ¼ ë– ì˜¬ëë‹¤. ë‹¨ìˆœí•œ ë„ë¡œê°€ ì•„ë‹ˆë‹¤. ì´ê²ƒì€ ë•… ë°‘ì— íë¥´ëŠ” <span class="txt-blue">ì—ë„ˆì§€ í˜ˆê´€</span>ì˜ ê²½ë¡œë‹¤.<br><br>
    
    <span class="section-title">ì‹ ì²´ ë°˜ì‘</span><br>
    ì•„í‹°íŒ©íŠ¸ê°€ ë–¨ë¦´ ë•Œë§ˆë‹¤ ì²™ì¶”ë¥¼ íƒ€ê³  ì˜¤ë¥´ëŠ” ì „ìœ¨ì´ ëŠê»´ì§„ë‹¤. ì´ ê°ê°ì€ ì§„ì§œë‹¤.<br><br>

    <span class="section-title">ëª©í‘œ ì§€ì </span><br>
    ì–¸ë• ì•„ë˜ ì‚¬ê±°ë¦¬. ê°€ì¥ í° íŒŒì¥ì´ ëŠê»´ì§€ëŠ” <span class="txt-red">ë„ë¡œí‘œì§€íŒ</span>ì„ ì¡°ì‚¬í•´ì•¼ í•œë‹¤.<br><br>

    (ì™¼ìª½ìœ¼ë¡œ ì´ë™. ì •ë©´ ê³„ë‹¨ ë²½ë©´ì˜ QRì½”ë“œ í™•ì¸.)`,
        answer: "ì¢…ë§",
        hint: "ì •ë‹µ í˜•íƒœ: í•œê¸€, ë„ë¡œ í‘œì§€íŒì˜ ê°€ë ¤ì§„ ë‹¨ì–´."
      },
      // 3. ì¢…ë§ -> OWNER (í¸ì˜ì )
      {
        subtitle: "2ì¥. ê¸°ì–µì„ ë¨¹ëŠ” ê³µì§„",
        text: `<span class="section-title">ì´ì „ ì •ë‹µ: ì¢…ë§?</span><br>
    ë‹¹ì‹ ì€ ì´ê³³ì˜ ìš´ëª…ì„ 'ì¢…ë§'ë¡œ ì½ì–´ëƒˆë‹¤. ê·¸ ë‹¨ì–´ê°€ ì—´ì‡ ê°€ ë˜ì–´ ìˆ˜ì²©ì˜ ë‹¤ìŒ ì¥ì„ ì—´ì—ˆë‹¤.<br><br>

    <span class="section-title">ìˆ˜ì²© ì—…ë°ì´íŠ¸</span><br>
    í˜ì´ì§€ ìœ„ë¡œ ê±°ì¹œ ì„  ë‘ ê°œê°€ êµì°¨í•œë‹¤. ì´ì „ë³´ë‹¤ í›¨ì”¬ <span class="txt-red">ê³µê²©ì ì¸ í˜•íƒœì˜ ë¬¸ì–‘</span>ì´ë‹¤.<br><br>

    <span class="section-title">ê²½ê³ </span><br>
    ë‚ ì¹´ë¡œìš´ ê¸°ê³„ìŒì´ ë“¤ë¦°ë‹¤. ê¸°ë ¥ ì†Œëª¨ìœ¨ ì¦ê°€. íŒŒë™ì˜ ê·¼ì›ì§€ëŠ” ê¸¸ ê±´ë„ˆí¸ì´ë‹¤.<br><br>

    <strong>[ì§€ì‹œ]</strong> <span class="txt-highlight">í¸ì˜ì  ë°©í–¥</span>ìœ¼ë¡œ ì´ë™í•˜ì—¬ 'ì£¼ì¸'ì˜ í”ì ì„ ì°¾ì•„ë¼.<br><br>
    (2ì¸µìœ¼ë¡œ ì´ë™. ê²Œì‹œíŒ ê·¼ì²˜ QRì½”ë“œ í™•ì¸.)`,
        answer: "OWNER",
        hint: "ì •ë‹µ í˜•íƒœ: ì˜ì–´, ê±´ë¬¼ì˜ ì°½ë¬¸ ëª¨ì–‘ê³¼ ì•ŒíŒŒë²³ ì¡°í•©."
      },
      // 4. OWNER -> ì„ ëŒ€ì˜ ìœ ì„œ (ë§ˆì„íšŒê´€)
      {
        subtitle: "3ì¥. ì§€í˜•ê³¼ íŒŒë™ì´ ë§ë¬¼ë¦¬ë‹¤",
        text: `<span class="section-title">ì´ì „ ì •ë‹µ: OWNER</span><br>
    ë‹¹ì‹ ì€ ì´ê³³ì˜ <strong>'ì£¼ì¸(OWNER)'</strong>ì„ í˜¸ëª…í–ˆë‹¤. ì´ë¦„ì´ ë¶ˆë¦° ì£¼ì¸(ê±°ëŒ€ ìƒëª…ì²´)ì´ ë‹¹ì‹ ì„ ì¸ì§€í•˜ê¸° ì‹œì‘í–ˆë‹¤.<br><br>

    <span class="section-title">ê²°ë¡  ë„ì¶œ</span><br>
    ì´ ì§€ë„ëŠ” ê°•ì´Œ ì „ì²´ë¥¼ ì—°ê²°í•œ <span class="txt-blue">ê±°ëŒ€ ìƒëª…ì²´ì˜ ì‹ ê²½ë§ë„</span>ë‹¤.<br>
    ìš°ë¦¬ëŠ” ì§€ê¸ˆ ì ë“  ìƒëª…ì²´ì˜ ëª¸ ìœ„ë¥¼ ê±·ê³  ìˆë‹¤.<br><br>

    <span class="section-title">ì´ë™ ê²½ë¡œ</span><br>
    íŒŒë™ ì‹ í˜¸ê°€ <strong>ë§ˆì„íšŒê´€ ì•</strong>ì—ì„œ ê°•í•˜ê²Œ ê°ì§€ëœë‹¤.<br><br>

    (ì˜¤ë¥¸ìª½ ë³µë„ë¡œ ì´ë™. ë³µë„ ë ê³„ë‹¨ ì•ˆìª½ QRì½”ë“œ í™•ì¸.)`,
        answer: "ì„ ëŒ€ì˜ ìœ ì„œ",
        hint: "ì •ë‹µ í˜•íƒœ: í•œê¸€. ë…¸ì„ ë„ ì •ë¥˜ì¥ê³¼ ê¸€ì ìˆœì„œ ì¡°í•©."
      },
      // 5. ì„ ëŒ€ì˜ ìœ ì„œ -> ê°•ë¬¼ (ë¶í•œê°•)
      {
        subtitle: "4ì¥. ìœ ì„œê°€ ê°€ë¦¬í‚¤ëŠ” ê³³",
        text: `<span class="section-title">ì´ì „ ì •ë‹µ: ì„ ëŒ€ì˜ ìœ ì„œ</span><br>
    ë‹¹ì‹ ì€ ì„ ëŒ€ ê°ì‘ìê°€ ë‚¨ê¸´ <strong>'ìœ ì„œ'</strong>ë¥¼ ì½ì—ˆë‹¤. ìœ ì„œë¥¼ ì½ì€ ìˆœê°„, ê·¸ ì˜ë¬´ì™€ ì €ì£¼ëŠ” ë‹¹ì‹ ì—ê²Œ <strong>ìŠ¹ê³„</strong>ë˜ì—ˆë‹¤.<br>

    <div class="txt-handwritten">
    ì´ê³³ì„ íë¥´ëŠ” ë¬¼ì¤„ê¸°ëŠ” ë‹¨ìˆœí•œ ê°•ì´ ì•„ë‹ˆë‹¤.<br>
    ì ë“¤ì–´ ìˆëŠ” ê±°ì‹ ì˜ <span class="txt-red">í˜ˆê´€</span>ì´ë‹¤.
    </div>

    <strong>[ì„ë¬´]</strong><br>
    ì§„ìœ„ í™•ì¸ì´ í•„ìš”í•˜ë‹¤. ë¶í•œê°•ë³€ì˜ <span class="txt-highlight">ë…¸ë€ ì¡°í˜•ë¬¼</span> ê·¼ì²˜ì—ì„œ í˜ˆê´€ì˜ ë§¥ë°•ì„ ì¸¡ì •í•˜ë¼.<br><br>

    (ê·¼ì²˜ì— ë¶€ì°©ëœ QRì½”ë“œ í™•ì¸.)`,
        answer: "ê°•ë¬¼",
        hint: "í•œê¸€, ê°•ì´Œì— ì—†ì–´ì„œëŠ” ì•ˆ ë˜ëŠ” ê²ƒ."
      },
      // 6. ê°•ë¬¼ -> ë¬¼ì•ˆê°œë¡œ í”¼ì–´ë‚˜ê³  (ëŒ€í”¼ì†Œ)
      {
        subtitle: "5ì¥. ìœ„í—˜í•œ ë§¥ë°•",
        text: `<span class="section-title">ê¸´ê¸‰ ìƒí™©</span><br>
    ê°•ë¬¼ì„ í™•ì¸í•˜ëŠ” ìˆœê°„, ìˆ˜ë©´ì´ ë¶‰ì€ í•ë¹›ìœ¼ë¡œ ì¼ë ì˜€ë‹¤. ì•„í‹°íŒ©íŠ¸ê°€ ë¹„ëª…(Scream)ì„ ì§€ë¥´ê³  ìˆë‹¤.<br><br>

    <span class="section-title">ì›ì¸ ë¶„ì„</span><br>
    í˜ˆê´€ì— ê³¼ë„í•˜ê²Œ ì ‘ê·¼í–ˆë‹¤. ê±°ëŒ€ ìƒëª…ì²´ì˜ ë©´ì—­ ì²´ê³„ê°€ ë‹¹ì‹ ì„ <span class="txt-red">ì¹¨ì…ì(Virus)</span>ë¡œ ì¸ì‹í•˜ì—¬ ê³µê²©ì„ ê°œì‹œí–ˆë‹¤.<br><br>

    <span class="section-title">ëŒ€ì‘ í–‰ë™</span><br>
    ìˆ¨ì„ ê³³ì´ í•„ìš”í•˜ë‹¤. ì¦‰ì‹œ <span class="txt-blue">ëŒ€í”¼ì†Œ</span>ë¡œ ì´ë™í•˜ë¼. ì¢Œí‘œëŠ” <strong>ì¹´í˜ 'THE1939'</strong>ë‹¤.<br><br>

    (ì˜ìƒë°”ì´ì˜¤ê´€ 414í˜¸ ë…¸í¬. ì•”êµ¬í˜¸: 'ì—´ë ¤ë¼ ì°¸ê¹¨')`,
        answer: "ë¬¼ì•ˆê°œë¡œ í”¼ì–´ë‚˜ê³ ",
        hint: "ì •ë‹µ í˜•íƒœ: í•œê¸€, ë¹„ë°€ìš”ì›ì—ê²Œ ë¬¸ì˜ ë˜ëŠ” QRì½”ë“œ ì¬í™•ì¸."
      },
      // 7. ë¬¼ì•ˆê°œ -> í”¼ì•”í„°ë„ (ê°ˆë¹„ë¼ˆ) *ê²½ê³ ì°½ ë°œìƒ*
      {
        subtitle: "6ì¥. ë“œëŸ¬ë‚œ ë¼ˆ",
        text: `<span class="section-title">ìƒíƒœ ë³´ê³ </span><br>
    ëŒ€í”¼ì†Œì—ì„œ ê²¨ìš° í˜¸í¡ì„ í™•ë³´í–ˆë‹¤. ê·¸ëŸ¬ë‚˜ ìˆ˜ì²©ì˜ 5í˜ì´ì§€ê°€ ì—´ë¦¬ì ì•„í‹°íŒ©íŠ¸ê°€ ë‹¤ì‹œ <span class="txt-red">í­ì£¼</span>í•œë‹¤.<br><br>
    
    <span class="section-title">ê´€ì¸¡ ëŒ€ìƒ</span><br>
    ë‹¨ìˆœí•œ í„°ë„ì´ ì•„ë‹ˆë‹¤. ì•„í‹°íŒ©íŠ¸ëŠ” "ë³¸ì²´ ë³µê·€" ì‹ í˜¸ë¥¼ ë³´ë‚´ê³  ìˆë‹¤.<br>
    ì € êµ¬ì¡°ë¬¼ì€ ë•… ìœ„ë¡œ ë“œëŸ¬ë‚œ <span class="txt-highlight"><span class="txt-red">ê±°ëŒ€í•œ ê°ˆë¹„ë¼ˆ</span></span>ë‹¤.<br><br>

    <span class="section-title">ìœ„í—˜</span><br>
    ë‹¹ì‹ ì€ ì œ ë°œë¡œ í¬ì‹ìì˜ ë±ƒì†(Rib cage)ìœ¼ë¡œ ì§„ì…í•˜ê³  ìˆë‹¤.<br><br>

    (ì—˜ë¦¬ë² ì´í„° ë‚´ë¶€ ë²½ë©´ QRì½”ë“œ í™•ì¸. íƒ‘ìŠ¹í•˜ì§€ ë§ ê²ƒ.)`,
        answer: "í”¼ì•”í„°ë„",
        hint: "ì •ë‹µ í˜•íƒœ: í•œê¸€, í„°ë„ ì´ë¦„(OOOO) ì…ë ¥."
      },
      // 8. í”¼ì•”í„°ë„ -> 13 (í¬í† ì¡´)
      {
        subtitle: "7ì¥. ê°ì‘ìì˜ ì§„ì‹¤",
        text: `<span class="section-title">ì´ì „ ì •ë‹µ: í”¼ì•”í„°ë„</span><br>
    ë‹¹ì‹ ì€ ì œ ë°œë¡œ 'í”¼ì•”(í”¼ë¥¼ í”¼í•˜ëŠ”)' í„°ë„ì´ ì•„ë‹Œ, <strong>'í”¼ë¥¼ ë¨¸ê¸ˆì€' ê°ˆë¹„ë¼ˆ</strong> ì†ìœ¼ë¡œ ë“¤ì–´ì™”ë‹¤. ì´ì œ ë˜ëŒì•„ê°ˆ ê¸¸ì€ ì—†ë‹¤.<br><br>

    <div class="txt-handwritten">
    ê°ì‘ìëŠ” ì„¸ê³„ë¥¼ ì§€íƒ±í•˜ëŠ” ë¶€í’ˆì´ë‹¤.<br>
    ì´ ìˆ˜ì²©ì€ ë¶€í’ˆì„ íšŒìˆ˜í•˜ê¸° ìœ„í•œ <span class="txt-red" style="font-family:inherit;">ì¥ì¹˜</span>ë‹¤.
    </div>

    <span class="section-title">ìƒí™© íŒë‹¨</span><br>
    ìš°ë¦¬ëŠ” ì˜ì›…ìœ¼ë¡œ ì„ íƒëœ ê²ƒì´ ì•„ë‹ˆì—ˆë‹¤. ê³¼ê±° ì‹¤ì¢…ëœ ê°ì‘ìë“¤ì€ ëª¨ë‘ ì´ê³³ì—ì„œ <span class="txt-red">'ì‚¬ìš©'</span>ë˜ì–´ ì†Œë©¸í–ˆë‹¤.<br><br>

    <span class="section-title">íƒˆì¶œ ì‹œë„</span><br>
    ì´ê³³ì„ ë²—ì–´ë‚˜ì•¼ í•œë‹¤. ë‹¤ì‹œ <span class="txt-blue">ê°•ì´Œì—­(ê°•ì˜ì‹¤)</span> ë°©í–¥ìœ¼ë¡œ íšŒê·€í•˜ë¼. ìƒìƒì—­ ë’¤í¸ <span class="txt-red">í¬í† ì¡´</span>ì—ì„œ ë¶‰ì€ ì‹ í˜¸ê°€ ì¡íŒë‹¤.<br><br>

    (3ì¸µ ê³„ë‹¨ ë²½ë©´ QRì½”ë“œ í™•ì¸.)`,
        answer: "13",
        hint: "ì •ë‹µ í˜•íƒœ: ìˆ«ì. í´ì§„ ì†ê°€ë½ ê°œìˆ˜."
      },
      // 9. Final (ì—”ë”©)
      {
        subtitle: "ìµœì¢…ì¥. ë‹¤ì‹œ, ì‹œì‘",
        text: `<span class="section-title">ì´ì „ ì •ë‹µ: 13</span><br>
    <strong>[ì¹´ìš´íŠ¸: 13]</strong> ì‹œìŠ¤í…œ ìœ ì§€ì— í•„ìš”í•œ 13ë²ˆì§¸ ë¶€í’ˆ. ì í•© íŒì •. íšŒìˆ˜ ì ˆì°¨ë¥¼ ê°œì‹œí•œë‹¤.<br><br>
    
    <span class="section-title">ì¢…ë£Œ ì‹œí€€ìŠ¤</span><br>
    ê°•ì´Œì—­ ë„ì°© ì§í›„, ì•„í‹°íŒ©íŠ¸ê°€ ì„ê³„ì ì„ ëŒíŒŒí–ˆë‹¤. ê³µê°„ ì™œê³¡ì´ ë°œìƒí•˜ë©° ì§€ë©´ì´ ì‚¬ë¼ì§„ë‹¤.<br><br>
    
    <span class="section-title">ì”ë¥˜ë¬¼</span><br>
    ì—°êµ¬ì›(ê°ì‘ì)ì€ ì‚¬ë¼ì§€ê³ , ë°”ë‹¥ì—” ë¬¸ì–‘ì´ ì‚¬ë¼ì§„ ë‚¡ì€ <strong>ìˆ˜ì²©</strong>ë§Œ ë‚¨ì•˜ë‹¤.<br><br>
    
    ...ì ì‹œ í›„, ë‹¤ë¥¸ ì—°êµ¬ì›ì´ ìˆ˜ì²©ì„ ë°œê²¬í•œë‹¤.<br>
    <div class="txt-handwritten">ì´ ìˆ˜ì²©ì„ ì¤ëŠ” ì...</div><br>
    
    <span class="txt-blue">ê³µì§„(Resonance) ì¬ê°€ë™.</span><br>
    ë‹¹ì‹ ì€ ìˆ˜ì²©ì„... <span class="txt-red">'ì§‘ì–´ë“ ë‹¤'.</span>`, 
        answer: "ì§‘ì–´ë“ ë‹¤", 
        hint: "ë§ˆì§€ë§‰ í–‰ë™ì„ ì…ë ¥í•˜ì„¸ìš”. (4ê¸€ì)"
      }
    ];

    // ë³€ìˆ˜ë“¤
    const totalStages = puzzles.length;
    let currentStage = 0;
    let maxUnlockedStage = 0;
    let pendingNextStage = 0; // ê²½ê³ ì°½ í™•ì¸ í›„ ì´ë™í•  ìŠ¤í…Œì´ì§€ ë²ˆí˜¸

    const stageLabelEl    = document.getElementById("stageLabel");
    const stageSubtitleEl = document.getElementById("stageSubtitle");
    const storyTextEl     = document.getElementById("storyText");
    const messageEl       = document.getElementById("message");
    const hintAreaEl      = document.getElementById("hintArea");
    const hintContentEl   = document.getElementById("hintContent");
    const answerInputEl   = document.getElementById("answerInput");
    const submitBtnEl     = document.getElementById("submitBtn");
    const answerAreaEl    = document.getElementById("answerArea");
    const clearBlockEl    = document.getElementById("clearBlock");
    const restartBtnEl    = document.getElementById("restartBtn");
    const gameContentEl   = document.getElementById("gameContent");
    const prevBtnEl       = document.getElementById("prevBtn");
    const nextBtnEl       = document.getElementById("nextBtn");
    const navControlsEl   = document.getElementById("navControls");
    
    // ì˜¤ë²„ë ˆì´ ì—˜ë¦¬ë¨¼íŠ¸
    const warningPopup = document.getElementById("warningPopup");
    const warningMsg = document.getElementById("warningMsg");
    const glitchScreen = document.getElementById("glitchScreen");
    const glitchMain = document.getElementById("glitchMainText");
    const glitchSub = document.getElementById("glitchSubText");

    function normalize(text) {
      return text.trim().replace(/\s/g, '').toLowerCase(); 
    }

    function updateProgress() {
      const total = totalStages;
      stageLabelEl.textContent    = `STAGE ${currentStage + 1} / ${total}`;
    }

    function renderStage() {
      if (gameContentEl) gameContentEl.style.display = "block";
      if (clearBlockEl) clearBlockEl.style.display = "none";
      if (navControlsEl) navControlsEl.style.display = "flex";

      const p = puzzles[currentStage];

      stageSubtitleEl.textContent = p.subtitle || "í˜„ì¥ ë¡œê·¸";
      storyTextEl.innerHTML       = p.text || ""; 
      messageEl.textContent       = "";
      messageEl.className         = "message";

      answerInputEl.value    = "";
      answerInputEl.disabled = false;
      submitBtnEl.disabled   = false;
      submitBtnEl.textContent = "í™•ì¸ (SUBMIT)";
      answerAreaEl.style.display = "block";

      hintContentEl.textContent = p.hint || "ì œê³µëœ íŒíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.";

      if (currentStage === 0 || currentStage === 1) {
          hintAreaEl.classList.add("active");
      } else {
          hintAreaEl.classList.remove("active");
      }
      const hintDetails = hintAreaEl.querySelector('details');
      if (hintDetails) hintDetails.removeAttribute('open');

      prevBtnEl.disabled = (currentStage === 0);
      nextBtnEl.disabled = (currentStage >= maxUnlockedStage);

      updateProgress();
      window.scrollTo(0, 0); 
    }

    function checkAnswer() {
      const userAnswer = normalize(answerInputEl.value);
      const correct    = normalize(puzzles[currentStage].answer || "");

      if (!userAnswer) {
        messageEl.textContent = "ì½”ë“œë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        messageEl.className   = "message error";
        return;
      }

      if (userAnswer === correct) {
        messageEl.textContent = "âœ… ì½”ë“œ í™•ì¸. ì ‘ê·¼ ìŠ¹ì¸.";
        messageEl.className   = "message success";

        submitBtnEl.disabled   = true;
        answerInputEl.disabled = true;
        
        // [ì—”ë”© ì—°ì¶œ] ë§ˆì§€ë§‰ ìŠ¤í…Œì´ì§€ ì •ë‹µ ì…ë ¥ ì‹œ
        if (currentStage === totalStages - 1) {
           submitBtnEl.textContent = "ë¶€í’ˆ íšŒìˆ˜ ì¤‘...";
           // 2ë‹¨ê³„ ê¸€ë¦¬ì¹˜ ì—°ì¶œ í•¨ìˆ˜ í˜¸ì¶œ
           triggerEndingSequence();
           return;
        }

        // ì¼ë°˜ ìŠ¤í…Œì´ì§€
        submitBtnEl.textContent = "ë°ì´í„° ì „ì†¡ ì¤‘...";
        setTimeout(() => {
          submitBtnEl.textContent = "í™•ì¸ (SUBMIT)";
          
          if (currentStage === maxUnlockedStage) {
             maxUnlockedStage++;
          }
          
          attemptMoveToStage(currentStage + 1);

        }, 800);
      } else {
        messageEl.textContent = "âŒ ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
        messageEl.className   = "message error";
      }
    }

    // ë‹¤ìŒ ìŠ¤í…Œì´ì§€ ì´ë™ ì‹œë„ (ê²½ê³ ì°½ ë¡œì§ í¬í•¨)
    function attemptMoveToStage(targetStage) {
      // 1. [Type A ê²½ê³ ] ìŠ¤í…Œì´ì§€ 7(í”¼ì•”í„°ë„) ì§„ì… ì‹œì—ë§Œ ë°œìƒ (1íšŒ í•œì •)
      if (targetStage === 7 && currentStage < 7) {
        showWarning(targetStage, "â›” ìœ„í—˜: ê±°ëŒ€ ìƒëª…ì²´ ë‚´ë¶€\nì´ê³³ì€ ë†ˆì˜ ë±ƒì†ì…ë‹ˆë‹¤.\nìƒì¡´ í™•ë¥  30% ë¯¸ë§Œ.");
        return;
      }

      currentStage = targetStage;
      renderStage();
    }

    // ê²½ê³ ì°½ ë„ìš°ê¸°
    function showWarning(nextStageIdx, msg) {
      pendingNextStage = nextStageIdx;
      warningMsg.innerHTML = msg.replace(/\n/g, "<br>");
      warningPopup.style.display = 'flex';
    }

    // ê²½ê³ ì°½ í™•ì¸ ë²„íŠ¼
    window.confirmWarning = function() {
      warningPopup.style.display = 'none';
      currentStage = pendingNextStage;
      renderStage();
    }

    // [ì—”ë”©] 2ë‹¨ê³„ ê¸€ë¦¬ì¹˜ ì—°ì¶œ: Error(Red) -> Success(Green) on White BG
    function triggerEndingSequence() {
      // 1ë‹¨ê³„: ì˜¤ë¥˜ (ë¶‰ì€ìƒ‰)
      glitchScreen.classList.remove('mode-success');
      glitchScreen.classList.add('mode-error');
      
      glitchMain.textContent = "SYSTEM FAILURE";
      glitchMain.setAttribute("data-text", "SYSTEM FAILURE");
      glitchSub.textContent = "CRITICAL ERROR: SUBJECT LOST";
      
      glitchScreen.style.display = 'flex';

      // 2.5ì´ˆ í›„: ë³µêµ¬ ì„±ê³µ (ì´ˆë¡ìƒ‰) - ë°˜ì „
      setTimeout(() => {
        glitchScreen.classList.remove('mode-error');
        glitchScreen.classList.add('mode-success'); // ì´ˆë¡ ìŠ¤íƒ€ì¼
        
        glitchMain.textContent = "SYSTEM RESTORED";
        glitchMain.setAttribute("data-text", "SYSTEM RESTORED");
        glitchSub.textContent = "NEW COMPONENT INSTALLED";
      }, 2500);

      // 5ì´ˆ í›„: í´ë¦¬ì–´ í™”ë©´ ì´ë™
      setTimeout(() => {
        glitchScreen.style.display = 'none';
        showClear();
      }, 5500);
    }

    function showClear() {
      stageLabelEl.textContent    = `SYSTEM RESTORED`;
      if (gameContentEl) gameContentEl.style.display = "none";
      if (navControlsEl) navControlsEl.style.display = "none";
      if (clearBlockEl) clearBlockEl.style.display  = "block";
      window.scrollTo(0, 0);
    }

    // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼
    prevBtnEl.addEventListener("click", () => {
      if (currentStage > 0) {
        currentStage--;
        renderStage();
      }
    });

    nextBtnEl.addEventListener("click", () => {
      if (currentStage < maxUnlockedStage) {
        attemptMoveToStage(currentStage + 1);
      }
    });

    submitBtnEl.addEventListener("click", checkAnswer);
    answerInputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter") checkAnswer();
    });

    if (restartBtnEl) {
      restartBtnEl.addEventListener("click", () => {
        if(confirm("ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ë£¨í”„ë¥¼ ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            currentStage = 0;
            maxUnlockedStage = 0; 
            renderStage();
        }
      });
    }

    renderStage();
  </script>
</body>
</html>
